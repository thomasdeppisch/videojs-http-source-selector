/**
 * videojs-http-source-selector
 * @version 1.1.7
 * @copyright 2020 Justin Fujita <Justin@pivotshare.com>
 * @license MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):(e=e||self)["videojs-http-source-selector"]=t(e.videojs)}(this,function(s){"use strict";function n(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var e=(s=s&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s).getComponent("MenuItem"),t=s.getComponent("Component"),u=function(o){function e(e,t){var n;return t.selectable=!0,t.multiSelectable=!1,(n=o.call(this,e,t)||this).update(),n}n(e,o);var t=e.prototype;return t.handleClick=function(){var e=this.options_;o.prototype.handleClick.call(this);for(var t=this.player().qualityLevels(),n=0;n<t.length;n++)e.index==t.length||e.index==n?t[n].enabled=!0:t[n].enabled=!1;t.trigger({type:"change",selectedIndex:e.index})},t.update=function(){for(var e=this.player().qualityLevels(),t=0,n=0;n<e.length;n++)e[n].enabled&&(t+=1);1===t?this.selected(this.options_.index===e.selectedIndex):this.selected(this.options_.index===e.length)},e}(e);t.registerComponent("SourceMenuItem",u);function o(e){var t=this;this.ready(function(){!function(o){if(o.addClass("vjs-http-source-selector"),"Html5"!==o.techName_)return;o.on(["loadedmetadata"],function(e){var t,n;"undefined"!==o.videojs_http_source_selector_initialized&&!0!==o.videojs_http_source_selector_initialized&&(o.videojs_http_source_selector_initialized=!0,n=(t=o.controlBar).getChild("fullscreenToggle").el(),t.el().insertBefore(t.addChild("SourceMenuButton").el(),n))})}(t,s.mergeOptions(i,e))}),s.registerComponent("SourceMenuButton",r),s.registerComponent("SourceMenuItem",u)}var d=s.getComponent("MenuButton"),r=function(l){function e(e,t){var n=l.call(this,e,t)||this;d.apply(a(n),arguments);var o=n.player().qualityLevels();if(t&&t.default)if("low"===t.default)for(var r=0;r<o.length;r++)o[r].enabled=0==r;else if("high"===t.default)for(var i=0;i<o.length;i++)o[i].enabled=i==o.length-1;return n.player().qualityLevels().on(["change","addqualitylevel"],s.bind(a(n),n.update)),n}n(e,l);var t=e.prototype;return t.createEl=function(){return s.dom.createEl("div",{className:"vjs-http-source-selector vjs-menu-button vjs-menu-button-popup vjs-control vjs-button"})},t.buildCSSClass=function(){return d.prototype.buildCSSClass.call(this)},t.createItems=function(){this.menuItems=[];for(var e=this.player().qualityLevels(),t=[],n=0;n<e.length;n++){var o=e.length-(n+1),r=o===e.selectedIndex,i=""+o,l=o;e[o].height?(i=e[o].height+"p",l=parseInt(e[o].height,10)):e[o].bitrate&&(i=Math.floor(e[o].bitrate/1e3)+" kbps",l=parseInt(e[o].bitrate,10)),0<=t.indexOf(i)||(t.push(i),this.menuItems.push(new u(this.player_,{label:i,index:o,selected:r,sortVal:l})))}return 1<e.length&&this.menuItems.push(new u(this.player_,{label:"Auto",index:e.length,selected:-1===e.selectedIndex,sortVal:99999})),this.menuItems.sort(function(e,t){return e.options_.sortVal<t.options_.sortVal?1:e.options_.sortVal>t.options_.sortVal?-1:0}),this.menuItems},e}(d),i={},l=s.registerPlugin||s.plugin;return l("httpSourceSelector",o),o.VERSION="1.1.7",o});